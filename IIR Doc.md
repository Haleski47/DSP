# äºŒé˜¶ Butterworth IIR ï¼ˆä½é€šï¼‰æ»¤æ³¢å™¨è®¾è®¡æ–‡æ¡£


## 1. å¼•è¨€

ç®€è¦ä»‹ç»æ»¤æ³¢å™¨çš„åŸç†æ¨å¯¼ã€æ¨¡å‹ä»¿çœŸä¸RTLå®ç°ã€‚

- IIRæ»¤æ³¢å™¨çš„åŸç†æ¨å¯¼ä¸ç®—æ³•ç»†èŠ‚  
- æµ®ç‚¹ä¸å®šç‚¹æ¨¡å‹ä»¿çœŸ(python)  
- RTLå®ç°(åŸºäºstratus system C)

---

### 2.1 Butterworth æ»¤æ³¢å™¨ç®€ä»‹

Butterworth æ»¤æ³¢å™¨æ˜¯ä¸€ç§å…·æœ‰æœ€å¤§é€šå¸¦å¹³å¦åº¦çš„æ¨¡æ‹Ÿæ»¤æ³¢å™¨ï¼Œå…¶é¢‘ç‡å“åº”çš„å¹³æ–¹åœ¨é€šå¸¦å†…å•è°ƒé€’å‡ï¼Œæ²¡æœ‰æ³¢çº¹ã€‚å…¶å½’ä¸€åŒ–é¢‘ç‡å“åº”ä¸ºï¼š

$$
|H(j\omega)|^2 = \frac{1}{1 + \left(\frac{\omega}{\omega_c}\right)^{2n}}
$$

å…¶ä¸­ï¼š

- Ï‰<sub>c</sub>ï¼šæˆªæ­¢è§’é¢‘ç‡  
- nï¼šæ»¤æ³¢å™¨é˜¶æ•°ï¼ˆæœ¬æ–‡ä¸­ä¸º 2ï¼‰

---

### 2.2 äºŒé˜¶å·´ç‰¹æ²ƒæ–¯æ¨¡æ‹Ÿä½é€šä¼ è¾“å‡½æ•°

äºŒé˜¶ Butterworth æ¨¡æ‹Ÿä½é€šæ»¤æ³¢å™¨çš„æ ‡å‡†å½¢å¼ä¸ºï¼š

$$
H(s) = \frac{\omega_c^2}{s^2 + \sqrt{2} \cdot \omega_c s + \omega_c^2}
$$

---

### 2.3 åŒçº¿æ€§å˜æ¢å…¬å¼ï¼ˆè¡¥å……ï¼‰

#### 2.3.1 å°†æ¨¡æ‹ŸåŸŸè½¬æ¢ä¸ºæ•°å­—åŸŸæ—¶æ‰€ä½¿ç”¨çš„åŒçº¿æ€§å˜æ¢å…¬å¼ä¸ºï¼š

$$
s = \frac{2}{T} \cdot \frac{1 - z^{-1}}{1 + z^{-1}}
$$
$$ 
T = \frac{1}{f_s}ï¼Œf_sä¸ºé‡‡æ ·é¢‘ç‡
$$


#### 2.3.2 ä»£å…¥$H(s)$ï¼š
$$H(z) = \frac{\omega_c^2}{\left( \frac{2}{T} \cdot \frac{1 - z^{-1}}{1 + z^{-1}} \right)^2 + \sqrt{2}\omega_c \left( \frac{2}{T} \cdot \frac{1 - z^{-1}}{1 + z^{-1}} \right) + \omega_c^2}$$


#### 2.3.3 åˆ†å­åˆ†æ¯åŒä¹˜$(1 + z^{-1})^2$ï¼š
$$
H(z) = \frac{ \omega_c^2 (1 + z^{-1})^2 }{
    \dfrac{4}{T^2} (1 - z^{-1})^2
    + \dfrac{2\sqrt{2}\omega_c}{T} (1 - z^{-2})
    + \omega_c^2 (1 + z^{-1})^2
}
$$

#### 2.3.4 å±•å¼€åˆ†æ¯ï¼š
$$
\text{åˆ†æ¯} = 
\underbrace{\left[ \left( \frac{2}{T} \right)^2 + \sqrt{2}\omega_c \frac{2}{T} + \omega_c^2 \right]}_{K_0} + 
\underbrace{\left[ -2 \left( \frac{2}{T} \right)^2 + 2\omega_c^2 \right]}_{K_1} z^{-1} + 
\underbrace{\left[ \left( \frac{2}{T} \right)^2 - \sqrt{2}\omega_c \frac{2}{T} + \omega_c^2 \right]}_{K_2} z^{-2}
$$

#### 2.3.5 å½’ä¸€åŒ–ä¼ é€’å‡½æ•°
$$H(z) = \frac{
\frac{\omega_c^2}{K_0} + \frac{2\omega_c^2}{K_0} z^{-1} + \frac{\omega_c^2}{K_0} z^{-2}
}{
1 + \frac{K_1}{K_0} z^{-1} + \frac{K_2}{K_0} z^{-2}
}$$
ä¸€èˆ¬å®šä¹‰ï¼š$$
\omega_c = 2 \pi f_c
$$
ä½†æ˜¯ï¼Œmatlabç­‰å·¥å…·å¯¹$\omega_c$è¿›è¡Œé¢„å¤±çœŸå˜æ¢ï¼š
$$
\omega_c = 2 f_s \tan\!\left( \frac{\pi f_c}{f_s} \right)
$$

ç³»æ•°ä¸ºï¼š
$$
\begin{aligned}
b_0 &= \omega_c^2 / K_0 \\
b_1 &= 2\omega_c^2 / K_0 \\
b_2 &= \omega_c^2 / K_0 \\
a_1 &= K_1 / K_0 \\
a_2 &= K_2 / K_0
\end{aligned}
$$

---

### 2.4 æ»¤æ³¢å™¨çš„æ—¶åŸŸå®ç°ï¼ˆå·®åˆ†æ–¹ç¨‹ï¼‰


ç”± IIR æ»¤æ³¢å™¨çš„ç³»ç»Ÿå‡½æ•°è¡¨è¾¾å¼ï¼š

$$
H(z) = \frac{Y(z)}{X(z)} = \frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}
$$

å°†å…¶å˜å½¢ä¸ºï¼š

$$
Y(z) \cdot (1 + a_1 z^{-1} + a_2 z^{-2}) = X(z) \cdot (b_0 + b_1 z^{-1} + b_2 z^{-2})
$$

å¯¹ä¸Šè¿°ç­‰å¼è¿›è¡Œå±•å¼€ï¼Œå¹¶å–å Z å˜æ¢ï¼ˆå¯¹åº”å›åˆ°æ—¶åŸŸï¼‰ï¼Œå¾—åˆ°ï¼š

$$
y[n] + a_1 y[n-1] + a_2 y[n-2] = b_0 x[n] + b_1 x[n-1] + b_2 x[n-2]
$$

æ¥ç€ï¼Œæˆ‘ä»¬å°†å¸¦æœ‰ \( y[n] \) çš„é¡¹ç§»åˆ°å·¦è¾¹ï¼Œå°†å…¶è§£å‡ºä¸ºï¼š

$$
y[n] = b_0 x[n] + b_1 x[n-1] + b_2 x[n-2] - a_1 y[n-1] - a_2 y[n-2]
$$

---

### 2.5 IIRä½é€šæ»¤æ³¢å™¨çš„å…¸å‹ç‰¹æ€§
#### 2.5.1 æ»¤æ³¢å™¨ç³»æ•°å…³ç³»
| ç‰¹æ€§ | æ•°å­¦å…³ç³» | ç‰©ç†æ„ä¹‰ |
|------|----------|----------|
| **åˆ†å­å¯¹ç§°æ€§** | $b_0 = b_2$ <br> $b_1 = 2b_0$ | ä½é€šæ»¤æ³¢å™¨åœ¨é€šå¸¦å†…çš„å¯¹ç§°é¢‘ç‡å“åº”ç‰¹æ€§ |
| **ç³»æ•°å’Œ** | $\sum b = \sum a$ <br> $b_0 + b_1 + b_2 = 1 + a_1 + a_2$ | ä¿è¯æ»¤æ³¢å™¨åœ¨ç›´æµï¼ˆé›¶é¢‘ç‡ï¼‰å¤„çš„å¢ç›Šä¸º1 |
| **ç¨³å®šæ€§æ¡ä»¶** | $\|a_2\| < 1$ <br> $\|a_1\| < 1 + a_2$ | ç¡®ä¿ç³»ç»Ÿç¨³å®šï¼Œç‰¹å¾æ–¹ç¨‹çš„æ ¹åœ¨å•ä½åœ†å†… |
| **å¢ç›Šçº¦æŸ** | $H(1) = \frac{\sum b}{\sum a} = 1$ | é›¶é¢‘ç‡å“åº”ä¸º1ï¼ˆæ— è¡°å‡ï¼‰ |
| **é«˜é¢‘è¡°å‡** | $H(-1) = \frac{b_0 - b_1 + b_2}{1 - a_1 + a_2} \approx 0$ | åœ¨å¥ˆå¥æ–¯ç‰¹é¢‘ç‡å¤„æœ‰æœ€å¤§è¡°å‡ |

##### è¯´æ˜ï¼š
 - åˆ†å­å¯¹ç§°æ€§ä¸ç³»æ•°å’Œå¯ç”±å‰æ–‡çš„å…¬å¼ä¸­å¾—å‡º
 - ç¨³å®šæ€§æ¡ä»¶ä¸è§åæ–‡çš„æç‚¹ç« èŠ‚æè¿°
 - å¢ç›Šçº¦æŸä¸­, é›¶é¢‘: $z = e^{j\theta}, \theta=0, z=1 $
 - é«˜é¢‘è¡°å‡ä¸­, é«˜é¢‘: $z = e^{j\theta}, \theta=\pi, z=-1 $

#### 2.5.2 é›¶æç‚¹
##### 2.5.2.1 é›¶æç‚¹çš„å…¬å¼æ¨å¯¼ï¼š
é›¶ç‚¹ï¼š$ B(z) = b_0 + b_1 z^{-1} + b_2 z^{-2} = 0 $ åˆ©ç”¨å¯¹ç§°æ€§ $b_0 = b_2$ å’Œ $b_1 = 2b_0$å¯ä»¥å¾—åˆ° $ z=-1$

æç‚¹ï¼š$ {p_{1,2} = \frac{-a_1 \pm j \sqrt{4a_2 - a_1^2}}{2}} $

æç‚¹çš„æ¨¡ï¼š$ \sqrt{a_2}$
##### ğŸ“Œ IIR æ»¤æ³¢å™¨é›¶æç‚¹æ ¸å¿ƒæ¦‚å¿µæ€»ç»“

| æ¦‚å¿µ             | æ•°å­¦è¡¨è¾¾å¼                                                                 | ç‰©ç†æ„ä¹‰                                                                                  |
|------------------|------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------|
| é›¶ç‚¹ä½ç½®         | $z_{\text{zero}} = -1$ ï¼ˆäºŒé‡æ ¹ï¼‰                                            | ä½äºå•ä½åœ†ä¸Šï¼Œå¯¹åº”å¥ˆå¥æ–¯ç‰¹é¢‘ç‡ ($f_s/2$)ï¼Œæä¾›é«˜é¢‘å®Œå…¨è¡°å‡                             |
| æç‚¹ä½ç½®         | $p_{1,2} = \dfrac{-a_1 \pm j \sqrt{4a_2 - a_1^2}}{2}$                          | å†³å®šé€šå¸¦ç‰¹æ€§ï¼Œé è¿‘ $z=1$ å¢å¼ºä½é¢‘é€šè¿‡ï¼Œè§’åº¦ $\theta$ å†³å®šè°æŒ¯é¢‘ç‡                     |
| é›¶ç‚¹æ–¹ç¨‹         | $z^2 + 2z + 1 = 0$                                                          | æºäºåˆ†å­å¤šé¡¹å¼å¯¹ç§°æ€§ $b_0 = b_2$, $b_1 = 2b_0$                                           |
| æç‚¹æ–¹ç¨‹         | $z^2 + a_1 z + a_2 = 0$                                                     | åˆ†æ¯å¤šé¡¹å¼å†³å®šç³»ç»ŸåŠ¨åŠ›å­¦ç‰¹æ€§                                                             |
| é›¶æç‚¹æ¨¡å€¼       | $r = \sqrt{a_2}$                                      | $r_{\text{pole}}$ å†³å®šè°æŒ¯å¼ºåº¦ï¼ˆ$r \uparrow \Rightarrow Q \uparrow$ï¼‰ï¼Œé›¶ç‚¹ $r=1$     |
| é›¶æç‚¹è§’åº¦ | $\theta_{\text{pole}} = \tan^{-1}\left(\dfrac{\sqrt{4a_2 - a_1^2}}{a_1}\right)$ | $\theta_{\text{pole}}$ å†³å®šè°æŒ¯é¢‘ç‡ï¼š$f_{\text{res}} = \dfrac{\theta}{2\pi}f_s$ |
| ç¨³å®šæ€§æ¡ä»¶ | $ \sqrt{a_2} < 1$  | æ‰€æœ‰æç‚¹å¿…é¡»åœ¨å•ä½åœ†å†…ï¼Œä¿è¯ç³»ç»Ÿç¨³å®š    |
| é¢‘ç‡å“åº”         | $H(e^{j\omega}) = \dfrac{\prod\| e^{j\omega} - z_k\|}{\prod\|e^{j\omega} - p_k\|}$ | é›¶ç‚¹è¡°å‡ç‰¹å®šé¢‘ç‡ï¼Œæç‚¹å¢å¼ºç‰¹å®šé¢‘ç‡ 
| ç›´æµå“åº”         | $H(1) = \dfrac{\sum b_k}{\sum a_k} = 1$                                     | ä¿è¯é›¶é¢‘ç‡ä¿¡å·æ— è¡°å‡é€šè¿‡                                                                 |
| é«˜é¢‘å“åº”         | $H(-1) = \dfrac{b_0 - b_1 + b_2}{1 - a_1 + a_2} = 0$                         | å¥ˆå¥æ–¯ç‰¹é¢‘ç‡å¤„å®Œå…¨è¡°å‡                                                                   |
| è„‰å†²å“åº”         | $h[n] = r^n \cos(\theta n) u[n]$                                             | æç‚¹å†³å®šè¡°å‡é€Ÿç‡ ($r$) å’ŒæŒ¯è¡é¢‘ç‡ ($\theta$)                                            |
| å“è´¨å› æ•°         | $Q = \dfrac{1}{2(1 - r)}$                                                   | è¡¡é‡æ»¤æ³¢å™¨é€‰æ‹©æ€§ï¼Œ$r \uparrow \Rightarrow Q \uparrow$                                   |

#### 2.5.3 å»ºç«‹æ—¶é—´ã€è¡°å‡æ•ˆåº”ã€æŒ¯é“ƒæ•ˆåº”
##### 2.5.3.1 å»ºç«‹æ—¶é—´
ä¸ºäº†æ¨å¯¼å»ºç«‹æ—¶é—´ï¼Œæˆ‘ä»¬åˆ†ææ»¤æ³¢å™¨çš„é˜¶è·ƒå“åº”ã€‚è¾“å…¥ä¸ºé˜¶è·ƒåºåˆ— $x[n] = u[n]$ï¼ˆå•ä½é˜¶è·ƒï¼‰ï¼Œå…¶ $z$ å˜æ¢ä¸ºï¼š

$$
X(z) = \frac{1}{1 - z^{-1}}
$$

è¾“å‡ºçš„ $z$ å˜æ¢ä¸ºï¼š

$$
Y(z) = H(z) \cdot X(z) = H(z) \cdot \frac{1}{1 - z^{-1}}
$$

å‡è®¾ $H(z)$ çš„åˆ†æ¯å¤šé¡¹å¼æœ‰ä¸¤ä¸ªæç‚¹ $p_1$ å’Œ $p_2$ï¼ˆå¤å…±è½­ï¼‰ï¼Œä¸” $H(z)$ åœ¨ $z = 1$ å¤„æ— æç‚¹ï¼ˆå³ç›´æµå¢ç›Šå­˜åœ¨ï¼‰ï¼Œåˆ™ $Y(z)$ å¯è¡¨ç¤ºä¸ºéƒ¨åˆ†åˆ†å¼åˆ†è§£ï¼š

$$
Y(z) = \frac{A}{1 - z^{-1}} + \frac{B}{1 - p_1 z^{-1}} + \frac{C}{1 - p_2 z^{-1}}
$$
å…¶ä¸­ï¼š
 - $ \frac{A}{1 - z^{-1}} $, å…¶é€†$z$å˜æ¢$Au[n]$,æ˜¯ç¨³æ€çš„å¢ç›Š
 - $ \frac{B}{1 - p_1 z^{-1}} $, å…¶é€†$z$å˜æ¢$B p_1^n u[n]$,æ˜¯ä»¥$p_1$æç‚¹ä¸ºæ ¸å¿ƒçš„è¡°å‡å“åº”
 - $ \frac{C}{1 - p_2 z^{-1}} $, å…¶é€†$z$å˜æ¢$C p_2^n u[n]$,æ˜¯ä»¥$p_2$æç‚¹ä¸ºæ ¸å¿ƒçš„è¡°å‡å“åº”
 - è€ƒè™‘åˆ°$p_1$ $p_2$ä¸ºå…±è½­å¤æ•°ï¼Œ$\frac{B}{1 - p_1 z^{-1}} + \frac{C}{1 - p_2 z^{-1}}$åœ¨æ—¶åŸŸçš„å“åº”$B p_1^n u[n] + C p_2^n u[n]$å¯ä»¥è½¬å˜ä¸º$e[n] = D r^n \cos(\theta n + \phi)$, $D$ç»è¿‡æ¨å¯¼ï¼Œçº¦ä¸º1

å¯ä»¥çœ‹åˆ°ï¼ŒIIRæ»¤æ³¢å™¨å¯¹äºé˜¶è·ƒå“åº”å¯ä»¥æ‹†åˆ†ä¸ºå¸¸é‡å¢ç›Š+æŒ‡æ•°è¡°å‡ï¼›å½“æŒ‡æ•°è¡°å‡é¡¹è¾¾åˆ°é¢„æœŸçš„æŠ–åŠ¨èŒƒå›´ $ \alpha=0.01$ æ—¶ï¼Œæˆ‘ä»¬åˆ¤å®šæ»¤æ³¢å™¨è¾¾åˆ°ç¨³å®šï¼Œå…¶å»ºç«‹æ—¶é—´ä¸º$t_s = n_s T \approx \frac{ \ln(1/\alpha) \cdot T }{ |\ln r|}=\frac{ 2 \ln(\alpha) \cdot T }{ \ln a_2}$
å…¶ä¸­ $T$ æ˜¯é‡‡æ ·æ—¶é—´

##### 2.5.3.2 è¡°å‡æ•ˆåº”ä¸æŒ¯é“ƒæ•ˆåº”ï¼š
ç”±å‰æ–‡æ¨å¯¼å¯ä»¥çŸ¥é“ï¼ŒIIRæ»¤æ³¢å™¨çš„æ—¶åŸŸå“åº”å¯ä»¥æ‹†åˆ†ä¸ºå¸¸é‡çš„é˜¶è·ƒä¿¡å·+è¡°å‡çš„ä½™å¼¦ä¿¡å·ï¼Œè¡°å‡çš„ä½™å¼¦ä¿¡å·åœ¨æ—¶åŸŸä¸Šè¡¨ç°ä¸ºæŒ¯é“ƒï¼›

æŒ¯é“ƒçš„å¹…å€¼: $r^n =a_2^{n/2}$

æŒ¯é“ƒçš„å‘¨æœŸ: $T=\dfrac{2 \pi}{\theta} = \dfrac{2 \pi} {\arctan\left( \dfrac{\sqrt{4 a_2 - a_1^2}}{\left| a_1 \right|} \right) }$

###### Dçš„æ¨å¯¼ï¼ˆè®¡ç®—å¤ªå¤æ‚ï¼Œåç»­å¾…è¡¥å……ï¼‰

### 2.6 IIRä½é€šæ»¤æ³¢å™¨çš„é‡åŒ–è¯¯å·®åˆ†æ
IIRæ»¤æ³¢å™¨çš„æµ®ç‚¹ä¼ é€’å‡½æ•°å¦‚å‰æ–‡æ‰€è¿°ï¼š
$$
H(z) = \frac{Y(z)}{X(z)} = \frac{b_0^{\text{float}} + b_1^{\text{float}} z^{-1} + b_2^{\text{float}} z^{-2}}{1 + a_1^{\text{float}} z^{-1} + a_2^{\text{float}} z^{-2}}
$$
åœ¨å®é™…ç¡¬ä»¶å®ç°(atria2, Pollux)æ—¶ï¼Œè¾“å…¥ä¸ºS16å®šç‚¹æ•°(è¾“å…¥ç”±æ¨¡æ‹Ÿä¼ ç»™æ•°å­—ï¼Œä¸éœ€è¦é‡åŒ–);æ»¤æ³¢å™¨ç³»æ•°é‡åŒ–è‡³U16,é‡åŒ–ç³»æ•°ä¸º$2^{-15}$,æ•°å€¼èŒƒå›´[0, 2);åé¦ˆçš„çš„$y_1$ $y_2$ä¸ºS16.11,åŒ…å«S16çš„æ•´æ•°éƒ¨åˆ†ä¸*U11*çš„å°æ•°éƒ¨åˆ†ã€‚

IIRæ»¤æ³¢å™¨çš„é‡åŒ–è¯¯å·®åŒ…å«2éƒ¨åˆ†:**æ»¤æ³¢å™¨ç³»æ•°çš„é‡åŒ–è¯¯å·®ä¸åé¦ˆ$y_1$ $y_2$çš„é‡åŒ–è¯¯å·®ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºåé¦ˆè·¯å¾„ä¸è¡°å‡æ•ˆåº”çš„å­˜åœ¨ï¼Œé‡åŒ–è¯¯å·®ä¼šç§¯ç´¯å¹¶æ”¾å¤§è‡³ç‰¹å®šå€ç‡åç¨³å®šã€‚**ã€‚

å¯ä»¥è¿è¡Œä»¿çœŸä»£ç  **IIR_quant_error_simulator.ipynb** è§‚æµ‹è¯¯å·®

#### 2.6.1 ç³»æ•°é‡åŒ–è¯¯å·®(å¿½è§†åé¦ˆ$y_1$ $y_2$çš„é‡åŒ–è¯¯å·®)
##### 2.6.1.1 ä½é¢‘(å¸¸æ•°) è¾“å…¥çš„é‡åŒ–è¯¯å·®
å½“è¾“å…¥ä¿¡å·ä¸ºå¹…å€¼ä¸ºSignalRangeçš„å¸¸æ•°æˆ–ä½é¢‘ä¿¡å·æ—¶ï¼Œ$z=1$
$$
\frac{Y^{float}}{X} = \frac{b_0^{\text{float}} + b_1^{\text{float}} z^{-1} + b_2^{\text{float}} z^{-2}}{1 + a_1^{\text{float}} z^{-1} + a_2^{\text{float}} z^{-2}}=\frac{b_0^{\text{float}}+b_1^{\text{float}}+b_2^{\text{float}}}{1+a_1^{\text{float}}+a_2^{\text{float}}}=\frac{\Sigma{b}}{\Sigma{a}}
$$

IIRæ»¤æ³¢å™¨çš„ç³»æ•°åœ¨è¿›è¡Œå®šç‚¹é‡åŒ–æ—¶ï¼Œå…¶ä¼ é€’å‡½æ•°ä¸ºï¼š
$$
b_0^{\text{fix}} = b_0^{\text{float}} + \delta_{b_0} \\
b_1^{\text{fix}} = b_1^{\text{float}} + \delta_{b_1} \\
b_2^{\text{fix}} = b_2^{\text{float}} + \delta_{b_2} \\
a_1^{\text{fix}} = a_1^{\text{float}} + \delta_{a_1} \\
a_2^{\text{fix}} = a_2^{\text{float}} + \delta_{a_2} \\
\delta_{b}=\delta_{b_0} + \delta_{b_1} + \delta_{b_2}\\
\delta_{a}=\delta_{a_1} + \delta_{a_2}\\
H(z)^{fix} = \frac{Y^{fix}}{X} = \frac{b_0^{\text{fix}} + b_1^{\text{fix}} z^{-1} + b_2^{\text{fix}} z^{-2}}{1 + a_1^{\text{fix}} z^{-1} + a_2^{\text{fix}} z^{-2}} = \frac{b_0^{\text{fix}} + b_1^{\text{fix}} + b_2^{\text{fix}} }{1 + a_1^{\text{fix}} + a_2^{\text{fix}} }=\frac{\Sigma{b}+\delta_{b}}{\Sigma{a}+\delta_{a}}
$$
æ€»çš„é‡åŒ–è¯¯å·®ä¸ºï¼š
$$
CoeffQuantError=Y^{fix}-Y^{float}=(\frac{\Sigma{b}+\delta_{b}}{\Sigma{a}+\delta_{a}}-\frac{\Sigma{b}}{\Sigma{a}})X=\frac{\Sigma{a}\Sigma{b}+\Sigma{b}\delta_{a}-\Sigma{a}\Sigma{b}-\Sigma{a}\delta_{b}}{(\Sigma{a}+\delta_{a})\Sigma{a}}X
$$
è€ƒè™‘åˆ°ä½é€šæ»¤æ³¢å™¨ä¸­ï¼Œ$\Sigma{a}=\Sigma{b}$ä¸”$\delta_{a}<<\Sigma{a}$,ä¸Šå¼å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ï¼š
$$
CoeffQuantError=\frac{\Sigma{b}\delta_{a}-\Sigma{a}\delta_{b}}{\Sigma{a} \Sigma{a}}X=\frac{\delta_{a}-\delta_{b}}{\Sigma{a}}X=\frac{\delta_{a}-\delta_{b}}{\Sigma{a}}\text{SignalRange}
$$
å…¶ä¸­ï¼Œ$\Sigma{a}$ä¸$\delta_{a}-\delta_{b}$åœ¨è®¾ç½®æˆªè‡³é¢‘ç‡ä¸é‡åŒ–ç³»æ•°(ä½å®½)æ—¶å³å¯ç¡®å®šã€‚
##### 2.6.1.2 ä½é¢‘(å¸¸æ•°) è¾“å…¥çš„é‡åŒ–è¯¯å·®
åœ¨è¾“å…¥ä¿¡å·é¢‘ç‡ä¸ä¸º0æ—¶ï¼Œä¼ é€’å‡½æ•°$H(z)$å†…çš„$z$æ— æ³•å–0ï¼›å› æ­¤å®é™…çš„å™ªå£°è¯¯å·®éœ€è¦é€šè¿‡ä»¿çœŸå¾—åˆ°ã€‚ç”±å®éªŒç»“æœå¯ä»¥è§‚æµ‹åˆ°ï¼šéšç€é¢‘ç‡å¢åŠ åˆ°fcï¼Œé‡åŒ–å™ªå£°é€æ¸å¢åŠ ï¼Œçº¦è¾¾åˆ°1.5å€ï¼›è¶…è¿‡æˆªè‡³é¢‘ç‡ï¼Œé‡åŒ–å™ªå£°è¡°å‡ã€‚

#### 2.6.2 åé¦ˆ$y_1$ $y_2$çš„é‡åŒ–è¯¯å·®(å¿½è§†æ»¤æ³¢å™¨ç³»æ•°çš„é‡åŒ–è¯¯å·®)
å½“åé¦ˆå›è·¯$y_1$ä¸$y_2$çš„ä½å®½è¾ƒå°æ—¶ï¼Œåé¦ˆå›è·¯çš„é‡åŒ–å™ªå£°æ— æ³•å¿½è§†ï¼Œåœ¨å®šç‚¹æ¨¡å‹ä»¿çœŸ/RTLå®ç°æ—¶ï¼Œè®¾ç½®åé¦ˆ$y_1 y_2$çš„å°æ•°ä½å®½ä¸º$r_b$
$$
y[n] = b_0 x[n] + b_1 x[n-1] + b_2 x[n-2] - âŒŠa_1 y[n-1] + a_2 y[n-2]âŒ‹)>>r_b
$$
å…¶ä¸­ï¼ŒâŒŠxâŒ‹ä¸ºå‘ä¸‹å–æ•´ï¼›$b_0 b_1 b_2 a_1 a_2$å‡ä¸ºU1.15çš„å®šç‚¹æ•° $x[n]$ä¸ºS16çš„å®šç‚¹æ•°ï¼Œ$y[n-1]$ä¸$y[n-2]$å‡ä¸ºç”¨äºåé¦ˆçš„S$16.r_b$çš„å®šç‚¹æ•°ã€‚ä¸‹è¿°ä»£ç å±•ç¤ºäº†$\Sigma(bx)-\Sigma(ay)$çš„æ•°æ®ç±»å‹;
```
sum = 0 1 1 0 1 0 1 0 1 1 0 1 1 1 1 0 0 0 0 0 1 1 1 1 1 0 1 0 1 0 1 0
      â””â”€â”€â”€Integer (High S16 bits) â”€â”€â”˜ â””â”€â”€â”€Fraction (Low 16 bits)â”€â”€â”€â”€â”˜
      <---------------  used for feed back  --------------->
      <--- Y(usd for y[n]output) ---> <----Reserved rb ---->
```
ç”±ä¸Šè¿°$y[n]$çš„æ—¶åºå…¬å¼å¯ä»¥å¾—åˆ°å®é™…çš„ä¼ é€’å‡½æ•°;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æœ¬å°ç« èŠ‚çš„å…¬å¼æ¨å¯¼ä¸­ä¸­ï¼Œå¿½è§†æ»¤æ³¢å™¨ç³»æ•°çš„å®šç‚¹è¯¯å·®ï¼Œå³$b^{float}=b^{fix}$ï¼›æ­¤å¤–ï¼Œåé¦ˆçš„é‡åŒ–å™ªå£°æ˜¯ä¸è¾“å…¥$X$æ— å…³ï¼š
$$
H(z)^{fix} = \frac{Y^{fix}}{X} = \frac{b_0 + b_1z^{-1} + b_2z^{-2}}{1 + a_1 z^{-1} + a_2z^{-2} + \delta_{y}} 
$$
å…¶ä¸­ï¼Œ$\delta_{y}$æ˜¯å¼•å…¥çš„é‡åŒ–è¯¯å·®å°é‡ï¼Œå¯ä»¥å¾—åˆ°åé¦ˆè¯¯å·®ï¼š
$$
FeedbackQuantError=Y^{fix}-Y^{float}=(\frac{\Sigma{b}}{\Sigma{a}+\delta_{y}}-\frac{\Sigma{b}}{\Sigma{a}})=\frac{\Sigma{a}\Sigma{b}-\Sigma{a}\Sigma{b}-\Sigma{b}\delta_{y}}{(\Sigma{a}+\delta_{y})\Sigma{a}}=\frac{\delta_{y}}{\Sigma{b}+\delta_{y}}=\frac{\delta_{y}}{\Sigma{b}}=\frac{2 ^ {-r_b}}{\Sigma{b}}
$$

#### 2.6.3 å¤šçº§æ¨¡å—çº§è”å¼•å…¥è¾“å…¥é‡åŒ–è¯¯å·®
$$
FeedbackQuantError=Y^{fix}-Y^{float}=\frac{\Sigma{b}\delta_{x}}{\Sigma{a}}=\delta_{x}
$$
å³è¾“å‡ºçš„é‡åŒ–è¯¯å·®ä¸ºè¾“å…¥çš„é‡åŒ–è¯¯å·®çš„ç›´ä¼ ï¼Œæ— å¢ç›Šã€‚